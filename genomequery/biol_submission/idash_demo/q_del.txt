include<tables.txt>
genome NA18506;

Discordant=select * from READS 
where location>=0 and mate_loc>=0 and 
(
	(mate_loc-location>1000 and mate_loc-location<100000) 
or 
	(location-mate_loc>1000 and location-mate_loc<100000)
)

Disc2Intrvl=select create_intervals() from Discordant using intervals(location, mate_loc, both_mates)


Deep_Intrvl=select merge_intervals(interval_count > 5) from Disc2Intrvl

out=select * from MAPJOIN Deep_Intrvl, Discordant using intervals(location, mate_loc, both_mates)

print out
