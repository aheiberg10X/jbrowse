include<tables.txt>
genome NA18506;

H1=select * from READS 
where location>=0 and mate_loc>=0 and 
(
	(mate_loc-location>1000 and mate_loc-location<100000) 
or 
	(location-mate_loc>1000 and location-mate_loc<100000)
)

H2=select create_intervals() from H1 using intervals(location, mate_loc, both_mates)


H3=select merge_intervals(blah > 5) from H2

out=select * from MAPJOIN H3, H1 using intervals(location, mate_loc, both_mates)

print out
