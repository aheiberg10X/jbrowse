include<tables.txt>
genome NA18507;

H1=select * from READS 
where location>=0 and mate_loc>=0 and 
(
	(mate_loc-location>1000 and mate_loc-location<2000000) 
or 
	(location-mate_loc>1000 and location-mate_loc<2000000)
)

H2=select create_intervals() from H1 using intervals(location, location+length)


H3=select merge_intervals(blah > 5) from H2

out=select * from MAPJOIN H3 using intervals(st, nd), H1 using intervals(location, location+length, both_mates)

print out
